---
title: "Unlocking Collaborative Power with Git, GitHub CI/CD, and LLMs in Pharma"
author: "Eli Miller, Ben Straub, Eric Nantz"
format: 
  revealjs:
    logo: images/rcon.png
    footer: Unlocking Collaborative Power with Git, GitHub CI/CD, and LLMs in Pharma
    transition: fade
    theme: serif
    chalkboard: true
revealjs-plugins:
  - codewindow
---

## Intro

Big Ideas:

* Tools that have been used on R Consortium FDA Pilots to collaborate and to ensure accuracy and reproducibility
* Pilots are great places to learn about how to deploy and interact with these tools!
* Pilots are demonstrations/educational opportunities to see open-source in use!

## Intro to R Consortium {.smaller}

<div style="text-align: center;"> <img src="./images/rconsortium.png" alt="xkcd" style="width: 1500px;"/> </div>

* Submission Working Group meets the first Friday of every month.  Open to all! Join the slack!

::: footer
[R Consortium](https://r-consortium.org/)
:::

## Intro to R Consortium R-based Submission Pilots to FDA

<div style="display: flex; justify-content: space-between; align-items: center;"> 
<img src="images/pilot1.png" alt="Hex 1" style="max-width: 18%; height: auto;"> 
<img src="images/pilot2.png" alt="Hex 2" style="max-width: 18%; height: auto;"> 
<img src="images/pilot3.png" alt="Hex 3" style="max-width: 18%; height: auto;"> 
<img src="images/pilot4a.png" alt="Hex 4a" style="max-width: 18%; height: auto;"> 
<img src="images/pilot4b.png" alt="Hex 4b" style="max-width: 20%; height: auto;">
<img src="images/pilot5.png" alt="Hex 5" style="max-width: 18%; height: auto;">
<img src="images/OIP.png" alt="Hex 5" style="max-width: 20%; height: auto;">
</div>

## Problem Statement

:::{.incremental}

* How do people in the Pilots collaborate, ensure accuracy and reproducibility while working across multiple companies, platforms, OS, timezone and skill sets?


* renv
* git, GitHub
* CI/CD
* LLMs

:::

# Reproducibile Environments

## Reproducibile Environments with Open Source Products

<div style="text-align: center;"> <img src="./images/replication_crisis.png" alt="xkcd" style="width: 350px;"/> </div>

::: footer
[xkcd](https://xkcd.com/)
:::

## Reproducibile Environments with Open Source Products

:::{.incremental}

* A drug company uses open source products, like R, to demonstrate that a drug is safe and effective.

* How can the company ensure the analysis is reproducible when given to a regulatory agency? 

:::

## renv: Reproducible R Package Environments <img src="./images/renv.png" alt="renv Hex Sticker" style="width: 75px; vertical-align: middle; margin-left: 10px;"/> {.smaller}

:::{.incremental}

* Isolates project-specific R package libraries
* Captures and locks package versions for reproducibility
  * `renv.lock`
  * FDA uses this to rebuild environment and LLMs consume to build the ADRG
  * The Pilots did/are using this - just in case this wasn't clear!! `renv.lock` is the anchor for everything.
* Simplifies dependency management and restoration
  * Packages depend on other packages!!
* Integrates smoothly with RStudio and other tools
* Facilitates collaboration by sharing a consistent environment
:::

## All the renv you need to know (just 8!) {.smaller}

:::{.incremental}
* `renv::init()`: Initializes a new renv project by creating a project-specific library and a lockfile. Use this at the start of a new project.

* `renv::install()`: Installs packages into your project‚Äôs local library. This command can install a package from CRAN, GitHub, or local source.

* `renv::snapshot()`: Captures the state of your current project environment and writes it to the renv.lock file. This ensures that the project dependencies are tracked for future use or collaboration.

* `renv::restore()`: Restores the project library from the renv.lock file. Use this when you‚Äôre setting up the project on a new system or when you need to ensure package versions match those recorded in the lockfile.
:::

## All the renv you need to know (just 8!) {.smaller}

:::{.incremental}
* `renv::update()`: Updates the packages in your project and optionally updates the renv.lock file with the new versions.

* `renv::status()`: Checks for any discrepancies between the state of the project‚Äôs library and the renv.lock file. This helps identify packages that might be out-of-sync.

* `renv::remove()`: Removes one or more packages from your project‚Äôs library, making it easy to manage unused dependencies.

* `renv::clean()`: Cleans up the project‚Äôs library by removing unused packages that aren‚Äôt required based on the renv.lock file.
:::

## renv tips and tricks

* We don't need to deliver every package to regulatory agencies, e.g. as we have built custom solutions to help with our processes we realized these are not actually used in the analysis.  How can we ignore them!?! 

* `.renvignore` is a big win here!  Just like a `.gitignore`
* Don't edit the `renv.lock` file manually - use the nice functions!
* Don't be scarred to update to latest packages either - but use the nice functions!

## LLM & ADRG with Ellmer

::::{.columns}

:::{.column width="45%"}

Manually generated ADRG from pilot 3

![](images/humanADRG.png)

:::

:::{.column width="50%"}

LLM generated ADRG in pilot 5

![](images/LLMADRG.png)

:::

::::

::: aside
* Courtesy of [Ning Leng](mailto:leng.ning@gene.com) ‚ú®
:::

## LLM & ADRG with btw

:::::{.columns}

::::{.column width="45%"}


![](images/btwPackage.png){height="200px"}

::: {.codewindow style="font-size: 0.4em;"}
```r 
btw(
  pkg,
  "write an one sentence description 
  on this package's functionality."
)
```
:::

::::


::::{.column width="50%"}

![](images/packageDescs.png)

::::

:::::

::: aside
* Thanks Ning!
:::

# Git/GitHub

## Gitflow

::::{.columns}

:::{.column width="50%"}

_Our goals_:

* To maximize useful dev work,

* to maximize code quality, and

* to maximize code velocity.

:::

:::{.column width="50%"}

![](images/nomnoml.png)

:::

::::

::: aside
* Nonauthoritative, only take the parts you need!
:::

:::{.notes}

In the past years I've seen a lot of different ways of using Git. Found a few main benifits from a well crafted gitflow. 

Max Dev work. 

Build from the ground up. Don't implement because you see it on this slide, or saw someone else do it

::: 

## Pull Requests and Collaboration

Code moving between branches or a transision of "state." A structured way for reviewing code

![](images/PRScreenshot.png){fig-align="center"}

:::{.notes}

Eli's notes

:::

## Code Quality *Automated*

:::: {.columns}

::: {.column witdth="50%"}

![](images/WorkflowScreenshot.png){height=500px}

:::

::: {.column width="50%"}

-   üï∫Code Style
-   üßπLinting
-   <span style="text-decoration: underline wavy red;">Spelling</span>
-   üìùTesting
-   üìäCode Coverage
-   ‚úÖBuild Check

:::

::::

:::{.notes}

Eli's notes

:::

## Code Quality *and* AI

::::: {.columns}

:::: {.column width="40%"}

üí¨ A **structured** chat

::: {.codewindow style="font-size: 0.4em;"}
tlf-qc.qmd
```r 
type <- type_object(
  diff_list = type_string(),
  conclusion = type_boolean(),
  diff_score = type_integer()
)
res <- chat$chat_structured(
  prompt,
  new_image,
  comp_image,
  type = type_qc_diffs
)
```

:::

::::

:::: {.column width="60%"}
ü§ñ and a **structured** result

![](images/BotComment.png)

::::

:::::

:::{.notes}

Eli's notes

:::

## üöÄDeployments

Code being deployed out to the world

![](images/deployment.png)

:::{.notes}

Eli's notes

:::

{{< include _automation.qmd >}}
